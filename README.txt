Сервер с двойной аутентификацией.
User с полями name и key отправляется клиентом через тело запроса в формате  JSON.
В теле ответа обратно приходит key.

При запросе инфо в заголовке x-username указывается имя пользователя.
В теле запроса в поле code передается код вычесленный функцией generateCode().
Миддлвар отсеивает запросы с неверным кодом.